import{F as e,r as t,b as r,I as n,c as l,B as s,d as o,e as a,f as c,T as i,g as p}from"./vendor.c381151c.js";import{B as m}from"./BasicLayoutCard.3bb4f24a.js";const u={domain:"域名",link:"链接",linkPrefix:"链接前缀",regex:"正则表达式"},x=window["com.rxliuli.UnblockWebRestrictions.configBlockApi"];const d=a=>{const[c]=e.useForm();function i(){c.resetFields()}return t.exports.createElement(e,{form:c,onFinish:async function(e){console.log("values: ",e);const t=e;x.add(function(e,...t){const r=new Set(t);return Object.entries(e).reduce(((e,[t,n])=>(r.has(t)&&Reflect.set(e,t,n),e)),{})}(t,"type","url")),o.success("添加成功"),a.onReload(),i()},onReset:i,layout:"vertical"},t.exports.createElement(e.Item,{label:"匹配模式",name:"type",rules:[{required:!0,message:"匹配模式没有选择"}]},t.exports.createElement(r,{options:Object.entries(u).map((([e,t])=>({label:t,value:e})))})),t.exports.createElement(e.Item,{label:"匹配值",name:"url",rules:[{required:!0,message:"匹配值不能为空"}]},t.exports.createElement(n,null)),t.exports.createElement(e.Item,{label:"测试需要匹配的 URL",name:"tempUrl",rules:[{type:"url",message:"测试需要匹配的 URL 必须是个 URL 啊喂 (#`O′)"},e=>({async validator(t,r){const n=e.getFieldsValue();if(!n.tempUrl)throw new Error("测试需要匹配的 URL 不能为空");if(!function(e,t){if("string"==typeof t)return e.host.includes(t);{const{type:r,url:n}=t;switch(r){case"domain":return e.host.includes(n);case"link":return e.href===n;case"linkPrefix":return e.href.startsWith(n);case"regex":return new RegExp(n).test(e.href)}}}(new URL(n.tempUrl),n))throw new Error("测试需要匹配的 URL 未能匹配！")}})],dependencies:["type","url"]},t.exports.createElement(n,null)),t.exports.createElement(e.Item,null,t.exports.createElement(l,null,t.exports.createElement(s,{type:"primary",htmlType:"submit"},"提交"),t.exports.createElement(s,{htmlType:"reset"},"清空"))))},E=e=>t.exports.createElement("div",null,t.exports.createElement("h2",null,"本地屏蔽配置列表"),t.exports.createElement(a,{dataSource:e.list,renderItem:(r,n)=>t.exports.createElement(a.Item,{key:n,actions:[t.exports.createElement(c,{checked:r.enable,onChange:()=>e.onSwitch(r)}),t.exports.createElement(s,{type:"danger",onClick:()=>e.onRemove(r)},"删除")]},t.exports.createElement(a.Item.Meta,{title:t.exports.createElement("div",null,t.exports.createElement(i,null,u[r.type]),t.exports.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:r.url},"regex"===r.type?r.url:t.exports.createElement("a",{href:("domain"===r.type?"https://":"")+r.url},r.url))),description:t.exports.createElement("div",null,r.enable)}))})),y=e=>t.exports.createElement(p,{style:{width:"100%"},title:e.title,extra:t.exports.createElement(s,{type:"primary",href:e.href},"去安装脚本")}),f=()=>{const[e,r]=t.exports.useState((()=>x.list()));function n(){const e=x.list();r(e),console.log("reload: ",e)}return t.exports.createElement(m,{title:"配置页",extra:t.exports.createElement("div",null,t.exports.createElement(s,{type:"primary",onClick:function(){x.clear(),n(),o.success("清空成功")},style:{marginRight:8}},"清空"),t.exports.createElement(s,{type:"primary",onClick:async function(){await x.update(),n(),o.success("更新成功")}},"更新"))},t.exports.createElement(d,{onReload:n}),t.exports.createElement(E,{list:e,onRemove:function(e){console.log("remove key: ",e.key),x.remove(e.key),n(),o.success("删除成功")},onSwitch:function(e){console.log("handleSwitch: ",e),x.switch(e.key),n()}}))};export default()=>x?t.exports.createElement(f,null):t.exports.createElement(y,{title:"您还未安装解除网页禁止复制/粘贴的脚本",href:"https://greasyfork.org/zh-CN/scripts/391193"});
